/*
  filename: integralui.groupbox.js
  version : 0.5.0 BETA
  Copyright Â© 2016 Lidor Systems. All rights reserved.

  This file is part of the "IntegralUI Web" Library. 
                                                                   
  The contents of this file are subject to the IntegralUI Web License, and may not be used except in compliance with the License.
  A copy of the License should have been installed in the product's root installation directory or it can be found at
  http://www.lidorsystems.com/products/web/iui-web-license-agreement.pdf.
                                                            
  This SOFTWARE is provided "AS IS", WITHOUT WARRANTY OF ANY KIND, either express or implied. See the License for the specific language 
  governing rights and limitations under the License. Any infringement will be prosecuted under applicable laws.                           
*/
var __extends=this&&this.__extends||function(e,a){function b(){this.constructor=e}for(var c in a)a.hasOwnProperty(c)&&(e[c]=a[c]);e.prototype=null===a?Object.create(a):(b.prototype=a.prototype,new b)},__decorate=this&&this.__decorate||function(e,a,b,c){var d=arguments.length,f=3>d?a:null===c?c=Object.getOwnPropertyDescriptor(a,b):c,g;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)f=Reflect.decorate(e,a,b,c);else for(var h=e.length-1;0<=h;h--)if(g=e[h])f=(3>d?g(f):3<d?g(a,b,f):
g(a,b))||f;return 3<d&&f&&Object.defineProperty(a,b,f),f},__metadata=this&&this.__metadata||function(e,a){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,a)},core_1=require("@angular/core"),integralui_core_1=require("./integralui.core"),integralui_common_service_1=require("../services/integralui.common.service"),IntegralUIGroupBox=function(e){function a(b,a,d){e.call(this,b);this.commonService=b;this.cmpResolver=a;this.baseService=d;this.expandState="none";
this.supressCallback=this.isSelected=this.isExpanded=!1;this.contentHeight="0";this.contentDisplay="block";this.contentOpacity=1;this.maxBlockHeight=0;this.parentCtrl=null;this.headerExpandBoxClassName=this.headerClassName=this.contentClassName="";this.contentClass=[];this.headerBlockClass=[];this.afterCollapse=new core_1.EventEmitter;this.afterExpand=new core_1.EventEmitter;this.beforeCollapse=new core_1.EventEmitter;this.beforeExpand=new core_1.EventEmitter;this.selectedChanged=new core_1.EventEmitter;
this.afterSelect=new core_1.EventEmitter;this.beforeSelect=new core_1.EventEmitter}__extends(a,e);Object.defineProperty(a.prototype,"expanded",{get:function(){return this.isExpanded},set:function(b){if(this.isExpanded!=b){var a=this;if(a.callBeforeEvent(b)){a.expandState=b?"expand":"collapse";var d=setTimeout(function(){"collapse"==a.expandState&&(a.expandState="none");clearTimeout(d)},300);a.isExpanded=b;a.header.animationState=a.isExpanded?"expand":"collapse";a.updateContentClass();a.toggleContent()}}},
enumerable:!0,configurable:!0});Object.defineProperty(a.prototype,"selected",{get:function(){return this.isSelected},set:function(b){if(this.isSelected!=b){var a={cancel:!1,group:this.data};this.beforeSelect.emit(a);1!=a.cancel&&(this.isSelected=b,this.header&&(this.header.state=b?this.header.state|integralui_core_1.IntegralUIObjectState.selected:this.header.state&~integralui_core_1.IntegralUIObjectState.selected),b&&this.afterSelect.emit({group:this.data}),this.selectedChanged.emit({group:this.data}),
this.updateHeaderBlockClass())}},enumerable:!0,configurable:!0});a.prototype.callBeforeEvent=function(b){var a=!0;this.parentCtrl&&this.parentCtrl.invokeEvent&&(a=this.parentCtrl.invokeEvent(b?"BEFORE_EXPAND":"BEFORE_COLLAPSE",this));a&&(a={cancel:!1,group:this.data},b?this.beforeExpand.emit(a):this.beforeCollapse.emit(a),a=!a.cancel);return a};a.prototype.callAfterEvent=function(b){var a={group:this.data};b?this.afterExpand.emit(a):this.afterCollapse.emit(a);this.parentCtrl&&this.parentCtrl.invokeEvent&&
this.parentCtrl.invokeEvent(b?"AFTER_EXPAND":"AFTER_COLLAPSE",this);return!0};a.prototype.ngOnInit=function(){this.parentCtrl=this.baseService.getComponent();this.generalClassName="iui-groupbox";this.headerClassName=this.generalClassName+"-header";this.headerExpandBoxClassName=this.headerClassName+"-expand-box";this.contentClassName=this.generalClassName+"-content";this.defaultStyle={general:{disabled:this.generalClassName+"-disabled",focused:this.generalClassName+"-focused",normal:this.generalClassName,
hovered:this.generalClassName+"-hovered",selected:this.generalClassName+"-selected"},header:{general:{disabled:this.headerClassName+"-disabled",focused:this.headerClassName+"-focused",normal:this.headerClassName,hovered:this.headerClassName+"-hovered",selected:this.headerClassName+"-selected"},expandBox:this.headerExpandBoxClassName},content:{general:this.contentClassName,expanded:this.contentClassName+"-expand",collapsed:this.contentClassName+"-collapse"}};this.updateStyle(this.controlStyle);this.updateControlClass();
this.updateContentClass();this.updateHeaderBlockClass()};a.prototype.ngAfterContentInit=function(){var a=this,c=setTimeout(function(){if(a.contentElem){var b=a.contentElem.nativeElement.firstElementChild.cloneNode(!0);b.style.position="absolute";b.style.top="-9999999px";a.controlElem.nativeElement.append(b);a.maxBlockHeight=b.offsetHeight;b.remove()}clearTimeout(c)},100)};a.prototype.ngOnDestroy=function(){};a.prototype.onHeaderClick=function(a){1==a.buttons&&(this.parentCtrl&&this.parentCtrl.invokeMethod?
this.parentCtrl.invokeMethod("SELECT_GROUP",this):(this.selected=!this.selected,this.expanded=!this.expanded))};a.prototype.collapse=function(){this.parentCtrl||(this.expanded=!1)};a.prototype.expand=function(){this.expanded=!0};a.prototype.toggle=function(){this.expanded=!this.expanded};a.prototype.toggleContent=function(){if(this.parentCtrl&&this.parentCtrl.invokeMethod)this.expanded&&this.parentCtrl.invokeMethod("TOGGLE_GROUPS",this);else{var a=this,c=0,d=0;if(a.expanded){a.contentDisplay="block";
var e=setInterval(function(){c<a.maxBlockHeight?(d=0==d?1:d+2,c+=d,a.contentHeight=c+"px"):(a.contentHeight="auto",a.expandState="none",a.callAfterEvent(!0),a.supressCallback=!1,clearInterval(e))},25)}else{a.maxBlockHeight=a.contentElem.nativeElement.offsetHeight;var c=a.maxBlockHeight,g=setInterval(function(){0<c?(d=0==d?1:d+2,c-=d,a.contentHeight=c+"px"):(a.contentDisplay="none",a.contentHeight="0",a.expandState="none",a.callAfterEvent(),a.supressCallback=!1,clearInterval(g))},25)}}};a.prototype.getContentHeight=
function(){return this.maxBlockHeight};a.prototype.setContentHeight=function(a){this.contentHeight=a};a.prototype.updateContentClass=function(){this.contentClass.length=0;this.contentClass.push(this.options.currentStyle.content.general);0!=this.expanded?"expand"==this.expandState&&this.contentClass.push(this.options.currentStyle.content.expanded):"collapse"==this.expandState&&this.contentClass.push(this.options.currentStyle.content.collapsed)};a.prototype.getContentClass=function(){return this.contentClass};
a.prototype.getContentStyle=function(a){return this.commonService.isString(a)?a:a?{general:this.commonService.isFieldAvailable(a.general,this.contentClassName),expanded:this.commonService.isFieldAvailable(a.expanded,this.contentClassName+"-expand"),collapsed:this.commonService.isFieldAvailable(a.collapsed,this.contentClassName+"-collapse")}:{general:this.defaultStyle.content.general,expanded:this.defaultStyle.content.expanded,collapsed:this.defaultStyle.content.collapsed}};a.prototype.updateHeaderBlockClass=
function(){this.headerBlockClass.length=0;this.headerBlockClass.push("iui-groupbox-header-block");this.selected&&this.headerBlockClass.push("iui-groupbox-header-marker-down")};a.prototype.getHeaderBlockClass=function(){return this.headerBlockClass};a.prototype.getHeaderClass=function(){var a=this.headerClassName;return a=this.state&integralui_core_1.IntegralUIObjectState.disabled?a+(" "+this.options.currentStyle.header.disabled):this.state&integralui_core_1.IntegralUIObjectState.focused?a+(" "+this.options.currentStyle.header.focused):
this.state&integralui_core_1.IntegralUIObjectState.selected?a+(" "+this.options.currentStyle.header.selected):this.state&integralui_core_1.IntegralUIObjectState.hovered?a+(" "+this.options.currentStyle.header.hovered):a+(" "+this.options.currentStyle.header.normal)};a.prototype.getHeaderGeneralStyle=function(a){return this.commonService.isString(a)?a:a?{disabled:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+"-disabled"),focused:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+
"-focused"),hovered:this.commonService.isFieldAvailable(a.hovered,this.headerClassName+"-hovered"),normal:this.commonService.isFieldAvailable(a.normal,this.headerClassName),selected:this.commonService.isFieldAvailable(a.selected,this.headerClassName+"-selected")}:{disabled:this.defaultStyle.header.disabled,focused:this.defaultStyle.header.focused,hovered:this.defaultStyle.header.hovered,normal:this.defaultStyle.header.normal,selected:this.defaultStyle.header.selected}};a.prototype.getHeaderStyle=
function(a){return{general:this.getHeaderGeneralStyle(a.general),expandBox:this.commonService.isFieldAvailable(a.expandBox,this.headerExpandBoxClassName)}};a.prototype.getCurrentHeaderStyle=function(){return this.options.currentStyle.header};a.prototype.setOpacity=function(a){this.contentOpacity=a};a.prototype.updateStyle=function(a){this.options.currentStyle=a?{general:this.getGeneralStyle(a.general),header:this.getHeaderStyle(a.header),content:this.getContentStyle(a.content)}:{general:{disabled:this.defaultStyle.general.disabled,
focused:this.defaultStyle.general.focused,hovered:this.defaultStyle.general.hovered,normal:this.defaultStyle.general.normal,selected:this.defaultStyle.general.selected},header:{general:{disabled:this.defaultStyle.header.general.disabled,focused:this.defaultStyle.header.general.focused,hovered:this.defaultStyle.header.general.hovered,normal:this.defaultStyle.header.general.normal,selected:this.defaultStyle.header.general.selected},expandBox:this.defaultStyle.header.expandBox},content:{general:this.defaultStyle.content.general,
expanded:this.defaultStyle.content.expanded,collapsed:this.defaultStyle.content.collapsed}}};__decorate([core_1.ViewChild("control",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],a.prototype,"controlElem",void 0);__decorate([core_1.ViewChild("content",{read:core_1.ViewContainerRef}),__metadata("design:type",core_1.ViewContainerRef)],a.prototype,"contentRef",void 0);__decorate([core_1.ViewChild("content",{read:core_1.ElementRef}),__metadata("design:type",core_1.ElementRef)],
a.prototype,"contentElem",void 0);__decorate([core_1.ViewChild("header"),__metadata("design:type",integralui_core_1.IntegralUIHeaderItem)],a.prototype,"header",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],a.prototype,"text",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],a.prototype,"icon",void 0);__decorate([core_1.Input(),__metadata("design:type",String)],a.prototype,"expandBoxType",void 0);__decorate([core_1.Input(),__metadata("design:type",Boolean),
__metadata("design:paramtypes",[Boolean])],a.prototype,"expanded",null);__decorate([core_1.Input(),__metadata("design:type",Boolean),__metadata("design:paramtypes",[Boolean])],a.prototype,"selected",null);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"afterCollapse",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"afterExpand",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,
"beforeCollapse",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"beforeExpand",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"selectedChanged",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"afterSelect",void 0);__decorate([core_1.Output(),__metadata("design:type",core_1.EventEmitter)],a.prototype,"beforeSelect",void 0);return a=__decorate([core_1.Component({moduleId:module.id,
selector:"iui-groupbox",templateUrl:"templates/integralui.groupbox.html",styleUrls:["css/integralui.groupbox.css"],inputs:["controlStyle","data","state"],encapsulation:core_1.ViewEncapsulation.None}),__metadata("design:paramtypes",[integralui_common_service_1.IntegralUICommonService,core_1.ComponentFactoryResolver,integralui_core_1.IntegralUIBaseService])],a)}(integralui_core_1.IntegralUIBaseComponent);exports.IntegralUIGroupBox=IntegralUIGroupBox;